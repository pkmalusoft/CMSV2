@model IEnumerable<CMSV2.Models.DRRRecPayVM>
@{
    //Layout = null;
    Layout = "~/Views/Shared/_TrueBookMstr.cshtml";
    ViewBag.Title = "Index";

    var isadd = true;
    var ismodify = true;
    var isdelete = true;
    var isprint = true;
    var isview = true;
    string path = "/CODReceipt/Index";

    if (Convert.ToInt32(Session["UserRoleID"]) > 1)
    {
        CMSV2.Models.SourceMastersModel obj = new CMSV2.Models.SourceMastersModel();
        isadd = obj.GetAddpermission(Convert.ToInt32(Session["UserRoleID"]), path);
        ismodify = obj.GetModifypermission(Convert.ToInt32(Session["UserRoleID"]), path);
        isdelete = obj.GetDeletepermission(Convert.ToInt32(Session["UserRoleID"]), path);
        isprint = obj.GetPrintpermission(Convert.ToInt32(Session["UserRoleID"]), path);
        isview = obj.GetViewpermission(Convert.ToInt32(Session["UserRoleID"]), path);

    }
}
<script src="~/Content/NewCSS/plugins/jQuery/moment.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/js/bootstrap-datetimepicker.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/css/bootstrap-datetimepicker.min.css" />
<style>
    .subtable tr td {
        padding: 5px;
    }
</style>
<script type="text/javascript">


    $(function () {
        $('#FromDate').datetimepicker({ format: 'DD-MM-YYYY' });

    });

    $(function () {
        $('#ToDate').datetimepicker({ format: 'DD-MM-YYYY' });

        $('#ToDate').datepicker("setDate", new Date());
    });

    $(function () {
        $('#txtpickuptime').datetimepicker({ format: 'DD-MM-YYYY HH:mm' });
    });

    //var table = $('#dataTables-example').DataTable();

</script>
<script type="text/javascript">

    function format(d) {
        // `d` is the original data object for the row
        var RecPayId = d[4];
        
        var DataHtml = '';
        $.ajax({
            type: "Get",
            url: "/MCManagement/GetMCAWBDetails",
            datatype: "Json",
            data: { Id: RecPayId },
            success: function (data) {
                DataHtml = '<table class="subtable">';
                $.each(data, function (index, value) {
                    DataHtml = DataHtml + '<tr><td  class="text-right">' + value.AWBNo + '</td><td>' + value.AWBDate + '</td><td>' + value.ConsignorName + '</td><td>' + value.ConsigneeName + '</td><td>' + parseFloat(value.MaterialCost).toFixed(2) + '</td><td>' + parseFloat(value.Amount).toFixed(2) + '</td></tr>';
                });
                DataHtml = DataHtml + '</table>';
                $('#pr_' + RecPayId).append(DataHtml);
            }
        });

        return '<p id="pr_' + RecPayId + '"></p>';
    }
    $(document).ready(function () {
        $('#dataTables-example tfoot th').each(function () {
            var title = $(this).text();
            $(this).html('<input type="text" />');
        });
        var table = $('#dataTables-example').DataTable({
            "aaSorting": [],
            //"dom": '<"top"i>rt<"top"flp><"clear">',
            //dom: "<'row'<'col-sm-3'l><'col-sm-3'f><'col-sm-6'p>>" +
            //       "<'row'<'col-sm-12'tr>>" +"<'row'<'col-sm-5'i><'col-sm-7'p>>",
            //"pagingType": "simple"
        });
        //table.draw();
        //table.columns().every(function () {
        //    var that = this;

        //    $('input', this.footer()).on('keyup change', function () {
        //        if (that.search() !== this.value) {
        //            that
        //                .search(this.value)
        //                .draw();
        //        }
        //    });
        //});

     
        //$('#dataTables-example').find('details-control').on('click',function () {
        $('#dataTables-example tbody').on('click', 'td.details-control', function () {
            debugger;
            var tr = $(this).closest('tr');
            var row = table.row(tr);
            if (row.child.isShown()) {
                // This row is already open - close it
                row.child.hide();
                tr.removeClass('shown');
                $(this).find('img').attr('src', '/Content/img/details_open.png');
            }
            else {
                // Open this row
                row.child(format(row.data())).show();
                tr.addClass('shown');
                $(this).find('img').attr('src', '/Content/img/details_close.png');
            }
        });



        if ('@ismodify' == 'False')
        {
            $('#dataTables-example').find('.aedit').each(function () {
                debugger;
                $(this).addClass('hide');
            });
        }
        if ('@isdelete' == 'False')
        {
            $('#dataTables-example').find('.adelete').each(function () {
                debugger;
                $(this).addClass('hide');
            });
        }
        if ('@isprint' == 'False')
        {
            $('#dataTables-example').find('.aprint').each(function () {
                debugger;
                $(this).addClass('hide');
            });
        }

    });
       

</script>

<section class="content-header" style="margin-bottom:20px">
    <h1 class="headingfont">MC Payment</h1>

</section>
<div>@{ Html.RenderAction("Table", "MCManagement");}</div>
@using (Html.BeginForm())
{
  

    <div class="table-responsive tblbackground" style="padding:15px;margin-top:20px">


        <table class="table table-responsive table-bordered tblfont" id="dataTables-example">
            <thead>
                <tr>
                    <th>
                        Mc Payment Voucher No.
                    </th>
                    <th>
                        Mc Payment Date
                    </th>
                    <th>Total Paid Amount</th>
                    <th width="5%"></th>
                    <th style="display:none;"></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td class="details-control">
                            <img src="/Content/img/details_open.png" id="plus_minus" style="cursor: pointer;" />
                            @Html.DisplayFor(modelItem => item.DocumentNo)
                        </td>
                        <td>                           
                            @CMSV2.Models.CommanFunctions.GetShortDateFormat(item.RecPayDate)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.FMoney)

                        </td>
                        <td style="font-size:13px">
                            @*<a target="_blank" href="ExportShipmentReport?id=@item.CustomerInvoiceID"><i class="fa fa-print"></i></a>*@
                            @*<a  class="aprint" target="_blank" href="InvoicePrint?id=@item.CustomerInvoiceID"><i class="fa fa-print"></i></a>*@

                            @*<a class="aview"  href="Details?id=@item.CustomerInvoiceID"><i class="fa fa-eye"></i></a><br />*@

                            <a class="aedit" href="Create?id=@item.RecPayID"><i class="fa fa-pencil"></i></a>

                            <a class="adelete" href="#" onclick="Delete(@item.RecPayID)"><i class="fa fa-times"></i></a>

                        </td>
                        <td style="display:none">
                            @item.RecPayID
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

}

<script>
        $(document).ready(function () {
            $("#importshipment").addClass("active");
            @if(TempData["toasterMessage"] != null)
            {
                @:toasterMessage("@TempData["toasterMessage"].ToString()");
            }
        });
        function deleteExport(id, controller) {
            debugger;
            swal({
                title: "Are you sure?",
                text: "You will not be able to recover this " + controller,
                type: "warning",
                showCancelButton: true,
                confirmButtonClass: "btn-danger",
                confirmButtonText: "Yes, delete it!",
                cancelButtonText: "No, cancel plx!",
                closeOnConfirm: false,
                closeOnCancel: false
            },
                function (isConfirm) {
                    if (isConfirm) {
                        $.ajax({
                            type: "POST",
                            datatype: "html",
                            url: "Delete?id=" + id.toString(),
                            data: id,
                            success: function (data) {
                                debugger;
                                swal({ title: "Deleted!", text: controller + " has been deleted.", type: "success" }, function () { window.location = window.location.href; });
                            }
                        });
                    } else {
                        swal("Cancelled", controller + " is safe :)", "error");
                    }
                });

        }
</script>

